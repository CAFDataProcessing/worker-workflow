<!--

    Copyright 2015-2017 EntIT Software LLC, a Micro Focus company.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<workflow>
    <details>
        <name>Enrichment Workflow</name>
        <description></description>
        <id>8</id>
    </details>
    <processingRules>
        <processingRule class="processingRule">
            <details>
                <name>Document Enrichment</name>
                <description>Enriches document metadata.</description>
                <id>15</id>
                <priority>100</priority>
                <enabled>true</enabled>
            </details>
            <actions>
                <action class="action">
                    <details>
                        <settings class="linked-hash-map">
                            <workerName>familyhashingworker</workerName>
                            <customData class="linked-hash-map"/>
                        </settings>
                        <name>Family Hashing</name>
                        <description>Perform family hashing and marking up of documents.</description>
                        <typeInternalName>ChainedActionType</typeInternalName>
                        <typeId>3</typeId>
                        <id>29</id>
                        <order>100</order>
                    </details>
                    <conditions/>
                </action>
                <action class="action">
                    <details>
                        <settings class="linked-hash-map">
                            <workerName>langdetectworker</workerName>
                            <customData class="linked-hash-map">
                                <fieldSpecs>CONTENT</fieldSpecs>
                            </customData>
                        </settings>
                        <name>LangDetect</name>
                        <description>Detects top 3 languages in an uploaded document.</description>
                        <typeInternalName>ChainedActionType</typeInternalName>
                        <typeId>3</typeId>
                        <id>30</id>
                        <order>200</order>
                    </details>
                    <conditions>
                        <condition class="condition">
                            <name>CONTENTexists AND MSG</name>
                            <additional class="linked-hash-map">
                                <order class="int">200</order>
                                <notes class="null"/>
                                <type>boolean</type>
                                <operator>and</operator>
                                <children class="list">
                                    <linked-hash-map class="linked-hash-map">
                                        <id class="int">93</id>
                                        <name>CONTENTexists</name>
                                        <additional class="linked-hash-map">
                                            <order class="int">100</order>
                                            <notes>CONTENT exists: CONTENTexists</notes>
                                            <type>exists</type>
                                            <field>CONTENT</field>
                                        </additional>
                                    </linked-hash-map>
                                    <linked-hash-map class="linked-hash-map">
                                        <id class="int">94</id>
                                        <name>msg</name>
                                        <additional class="linked-hash-map">
                                            <order class="int">200</order>
                                            <notes>DOC_FORMAT_CODE is 345:msg</notes>
                                            <type>string</type>
                                            <value>345</value>
                                            <operator>is</operator>
                                            <field>DOC_FORMAT_CODE</field>
                                        </additional>
                                    </linked-hash-map>
                                </children>
                            </additional>
                            <id>92</id>
                        </condition>
                    </conditions>
                </action>
                <action class="action">
                    <details>
                        <settings class="linked-hash-map">
                            <workerName>entityextractworkerhandler</workerName>
                            <customData class="linked-hash-map">
                                <OPERATION_MODE>DETECT</OPERATION_MODE>
                                <GRAMMAR_MAP>{pii.xml: []}</GRAMMAR_MAP>
                            </customData>
                        </settings>
                        <name>EntityExtract</name>
                        <description>Detects PII in an uploaded document.</description>
                        <typeInternalName>ChainedActionType</typeInternalName>
                        <typeId>3</typeId>
                        <id>31</id>
                        <order>300</order>
                    </details>
                    <conditions>
                        <condition class="condition">
                            <name>Has CONTENT and is Media</name>
                            <additional class="linked-hash-map">
                                <order class="int">200</order>
                                <notes class="null"/>
                                <type>boolean</type>
                                <operator>and</operator>
                                <children class="list">
                                    <linked-hash-map class="linked-hash-map">
                                        <id class="int">98</id>
                                        <name>CONTENTexists</name>
                                        <additional class="linked-hash-map">
                                            <order class="int">100</order>
                                            <notes>CONTENT exists: CONTENTexists</notes>
                                            <type>exists</type>
                                            <field>CONTENT</field>
                                        </additional>
                                    </linked-hash-map>
                                    <linked-hash-map class="linked-hash-map">
                                        <id class="int">99</id>
                                        <name>Audio/Video</name>
                                        <additional class="linked-hash-map">
                                            <order class="int">200</order>
                                            <notes class="null"/>
                                            <type>boolean</type>
                                            <operator>or</operator>
                                            <children class="list">
                                                <linked-hash-map class="linked-hash-map">
                                                    <id class="int">100</id>
                                                    <name>Sound</name>
                                                    <additional class="linked-hash-map">
                                                        <order class="int">100</order>
                                                        <notes>DOC_CLASS_CODE is 9</notes>
                                                        <type>string</type>
                                                        <value>9</value>
                                                        <operator>is</operator>
                                                        <field>DOC_CLASS_CODE</field>
                                                    </additional>
                                                </linked-hash-map>
                                                <linked-hash-map class="linked-hash-map">
                                                    <id class="int">101</id>
                                                    <name>Movie</name>
                                                    <additional class="linked-hash-map">
                                                        <order class="int">200</order>
                                                        <notes>DOC_CLASS_CODE is 20</notes>
                                                        <type>string</type>
                                                        <value>20</value>
                                                        <operator>is</operator>
                                                        <field>DOC_CLASS_CODE</field>
                                                    </additional>
                                                </linked-hash-map>
                                            </children>
                                        </additional>
                                    </linked-hash-map>
                                </children>
                            </additional>
                            <id>97</id>
                        </condition>
                    </conditions>
                </action>
            </actions>
            <conditions/>
        </processingRule>
        <processingRule class="processingRule">
            <details>
                <name>Output</name>
                <description>Output processed document.</description>
                <id>16</id>
                <priority>200</priority>
                <enabled>true</enabled>
            </details>
            <actions>
                <action class="action">
                    <details>
                        <settings class="linked-hash-map">
                            <workerName>worker-indexelastic</workerName>
                            <queueName>worker-indexelastic-in</queueName>
                        </settings>
                        <name>Send to Output Queue</name>
                        <description>Send to Enrichment Output Queue.</description>
                        <typeInternalName>ChainedActionType</typeInternalName>
                        <typeId>3</typeId>
                        <id>32</id>
                        <order>100</order>
                    </details>
                    <conditions/>
                </action>
            </actions>
            <conditions/>
        </processingRule>
    </processingRules>
</workflow>
